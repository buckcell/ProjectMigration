unit ConnectionFactory;

interface

uses
  System.SysUtils, System.Classes, Vcl.Forms, FireDAC.Stan.Intf, FireDAC.Stan.Option,
  FireDAC.Stan.Error, FireDAC.UI.Intf, FireDAC.Phys.Intf, FireDAC.Stan.Def,
  FireDAC.Stan.Pool, FireDAC.Stan.Async, FireDAC.Phys, FireDAC.Phys.FB,
  FireDAC.Phys.FBDef, FireDAC.VCLUI.Wait, Data.DB, FireDAC.Comp.Client,
  FireDAC.Stan.Param, FireDAC.DatS, FireDAC.DApt.Intf, FireDAC.DApt,
  FireDAC.Comp.DataSet;

type
  TConnFactory = class(TDataModule)
    Conn: TFDConnection;
    Trans: TFDTransaction;
    QueryProdutos: TFDQuery;
    QueryProdutosID: TIntegerField;
    QueryProdutosCODGRU: TIntegerField;
    QueryProdutosCODPRO: TStringField;
    QueryProdutosCODBAR: TStringField;
    QueryProdutosNOMPRO: TStringField;
    QueryProdutosCODFOR: TIntegerField;
    QueryProdutosNOMFOR: TStringField;
    QueryProdutosUN: TStringField;
    QueryProdutosTRIBUT: TStringField;
    QueryProdutosREF: TStringField;
    QueryProdutosIPI_E: TBCDField;
    QueryProdutosICMS_E: TBCDField;
    QueryProdutosDH_CAD: TSQLTimeStampField;
    QueryProdutosDH_ALT: TSQLTimeStampField;
    QueryProdutosDH_ESTOQUE: TSQLTimeStampField;
    QueryProdutosDT_UVENDA: TDateField;
    QueryProdutosDT_UCOMPRA: TDateField;
    QueryProdutosUPVEN: TBCDField;
    QueryProdutosDT_ALT_PRECO: TDateField;
    QueryProdutosLUCRO1: TBCDField;
    QueryProdutosPVENDA: TBCDField;
    QueryProdutosPCUSTOL: TBCDField;
    QueryProdutosPCUSTOB: TBCDField;
    QueryProdutosPCUSTOM: TBCDField;
    QueryProdutosESTOQUE: TBCDField;
    QueryProdutosESTMIN: TBCDField;
    QueryProdutosGRADE: TStringField;
    QueryProdutosQUANTINV: TStringField;
    QueryProdutosALIQUOTA: TBCDField;
    QueryProdutosOBSERVACAO: TStringField;
    QueryProdutosCST: TStringField;
    QueryProdutosNCM: TStringField;
    QueryProdutosTIPO: TSmallintField;
    QueryProdutosIAT: TStringField;
    QueryProdutosIPPT: TStringField;
    QueryProdutosATIVO: TStringField;
    QueryProdutosMARCA: TStringField;
    QueryProdutosORIG: TStringField;
    QueryProdutosID_PIS_COFINS: TSmallintField;
    QueryProdutosID_SECAO: TSmallintField;
    QueryProdutosSECAO_POS: TIntegerField;
    QueryProdutosCODPOSSE: TSmallintField;
    QueryProdutosIBPT_ALIQ: TCurrencyField;
    QueryProdutosCOMPOSICAO: TStringField;
    QueryProdutosPESO_G: TIntegerField;
    QueryProdutosESTFIS: TBCDField;
    QueryProdutosLINK: TStringField;
    QueryProdutosCOD_BALANCA: TIntegerField;
    QueryProdutosID_SUBSECAO: TIntegerField;
    QueryProdutosPESO_BRUTO: TBCDField;
    QueryProdutosUSA_INDICE: TSmallintField;
    QueryProdutosVR_INDICE: TBCDField;
    QueryProdutosCEST: TStringField;
    QueryProdutosOBS_NFE: TStringField;
    QueryProdutosID_EMP: TSmallintField;
    QueryProdutosID_MARCAS: TIntegerField;
    QueryProdutosPVENDAP: TBCDField;
    QueryProdutosALT: TSmallintField;
    QuerySQL: TFDQuery;
    IntegerField1: TIntegerField;
    IntegerField2: TIntegerField;
    StringField1: TStringField;
    StringField2: TStringField;
    StringField3: TStringField;
    IntegerField3: TIntegerField;
    StringField4: TStringField;
    StringField5: TStringField;
    StringField6: TStringField;
    StringField7: TStringField;
    BCDField1: TBCDField;
    BCDField2: TBCDField;
    SQLTimeStampField1: TSQLTimeStampField;
    SQLTimeStampField2: TSQLTimeStampField;
    SQLTimeStampField3: TSQLTimeStampField;
    DateField1: TDateField;
    DateField2: TDateField;
    BCDField3: TBCDField;
    DateField3: TDateField;
    BCDField4: TBCDField;
    BCDField5: TBCDField;
    BCDField6: TBCDField;
    BCDField7: TBCDField;
    BCDField8: TBCDField;
    BCDField9: TBCDField;
    BCDField10: TBCDField;
    StringField8: TStringField;
    StringField9: TStringField;
    BCDField11: TBCDField;
    StringField10: TStringField;
    StringField11: TStringField;
    StringField12: TStringField;
    SmallintField1: TSmallintField;
    StringField13: TStringField;
    StringField14: TStringField;
    StringField15: TStringField;
    StringField16: TStringField;
    StringField17: TStringField;
    SmallintField2: TSmallintField;
    SmallintField3: TSmallintField;
    IntegerField4: TIntegerField;
    SmallintField4: TSmallintField;
    CurrencyField1: TCurrencyField;
    StringField18: TStringField;
    IntegerField5: TIntegerField;
    BCDField12: TBCDField;
    StringField19: TStringField;
    IntegerField6: TIntegerField;
    IntegerField7: TIntegerField;
    BCDField13: TBCDField;
    SmallintField5: TSmallintField;
    BCDField14: TBCDField;
    StringField20: TStringField;
    StringField21: TStringField;
    SmallintField6: TSmallintField;
    IntegerField8: TIntegerField;
    BCDField15: TBCDField;
    SmallintField7: TSmallintField;
    QueryClientes: TFDQuery;
    QueryClientesID: TIntegerField;
    QueryClientesNOMCLI: TStringField;
    QueryClientesAPELIDO: TStringField;
    QueryClientesLOGRADOURO: TStringField;
    QueryClientesNUMERO: TStringField;
    QueryClientesCOMPLEMENTO: TStringField;
    QueryClientesSETOR: TStringField;
    QueryClientesTELRES: TStringField;
    QueryClientesCASAP: TStringField;
    QueryClientesID_CIDADES: TStringField;
    QueryClientesCIDADE: TStringField;
    QueryClientesCEP: TStringField;
    QueryClientesESTADO: TStringField;
    QueryClientesPROFISSAO: TStringField;
    QueryClientesENDPROF: TStringField;
    QueryClientesSETPROF: TStringField;
    QueryClientesTELPROF: TStringField;
    QueryClientesFIN_RENDA: TBCDField;
    QueryClientesCONJUGE: TStringField;
    QueryClientesCPF_CNPJ: TStringField;
    QueryClientesRG_INSC: TStringField;
    QueryClientesORGEM: TStringField;
    QueryClientesDATNASC: TDateField;
    QueryClientesNATURALIDADE: TStringField;
    QueryClientesPAI: TStringField;
    QueryClientesMAE: TStringField;
    QueryClientesIPESS1: TStringField;
    QueryClientesCRED1: TStringField;
    QueryClientesOBSERV1: TStringField;
    QueryClientesDATCAD: TDateField;
    QueryClientesCREDITO: TStringField;
    QueryClientesSITUACAO: TStringField;
    QueryClientesTELCEL: TStringField;
    QueryClientesEMAIL: TStringField;
    QueryClientesTIPO_PESS: TStringField;
    QueryClientesDAT_EMI: TDateField;
    QueryClientesAP_CRED: TStringField;
    QueryClientesVEICULO: TStringField;
    QueryClientesFIN_LCREDITO: TBCDField;
    QueryClientesLNOTAS: TBCDField;
    QueryClientesCODCONV: TBCDField;
    QueryClientesMARCA: TStringField;
    QueryClientesVENDEDOR: TIntegerField;
    QueryClientesUCOMPRA: TDateField;
    QueryClientesTIPO: TStringField;
    QueryClientesTELRES2: TStringField;
    QueryClientesFAX1: TStringField;
    QueryClientesSITE: TStringField;
    QueryClientesSEXO: TStringField;
    QueryClientesTELCEL_OP: TSmallintField;
    QueryClientesCRT: TSmallintField;
    QueryClientesDATA_ATUALIZACAO: TSQLTimeStampField;
    QueryClientesESTADOCIVIL: TStringField;
    QueryClientesCOB_LOGRADOURO: TStringField;
    QueryClientesCOB_NUMERO: TStringField;
    QueryClientesCOB_COMPLEMENTO: TStringField;
    QueryClientesCOB_SETOR: TStringField;
    QueryClientesCOB_CIDADE: TStringField;
    QueryClientesCOB_ID_CIDADES: TStringField;
    QueryClientesCOB_CEP: TStringField;
    QueryClientesCOB_ESTADO: TStringField;
    QueryClientesCARTAO_RENDA: TStringField;
    QueryClientesFIN_DIAFIXO: TIntegerField;
    QueryClientesFIN_VRMENSAL: TBCDField;
    QueryClientesFIN_TIPO_RECEB: TSmallintField;
    QueryClientesPERFIL_FB: TStringField;
    QueryClientesTELCEL2: TStringField;
    QueryClientesTELCEL2_OP: TSmallintField;
    QueryClientesTELCEL_WAPP: TSmallintField;
    QueryClientesTELCEL2_WAPP: TSmallintField;
    QueryClientesTELCEL_CONTATO: TStringField;
    QueryClientesTELCEL2_CONTATO: TStringField;
    QueryClientesID_EMP: TSmallintField;
    QueryClientesFIN_ID_FORMAS_PGT: TIntegerField;
    QueryClientesTIPO_ENTREGA: TSmallintField;
    QueryClientesPROD_RURAL: TStringField;
    QueryClientesTIPO_IE: TSmallintField;
    QueryClientesID_MIG: TIntegerField;
    QueryClientesALT: TSmallintField;
    procedure DataModuleCreate(Sender: TObject);
  private
    { Private declarations }
  public
    { Public declarations }
  end;

var
  ConnFactory: TConnFactory;

implementation

{%CLASSGROUP 'Vcl.Controls.TControl'}

{$R *.dfm}

procedure TConnFactory.DataModuleCreate(Sender: TObject);
begin
  if FileExists(ExtractFilePath(Application.ExeName) + '..\..\DB\NSC.FDB') then
  begin
    Conn.Params.Database := ExtractFilePath(Application.ExeName) + '..\..\DB\NSC.FDB';
  end
  else
  begin
    Conn.Params.Database := ExtractFilePath(Application.ExeName) + 'DB\NSC.FDB';
  end;
  QueryClientes.Active := true;
  QueryProdutos.Active := true;
end;

end.
